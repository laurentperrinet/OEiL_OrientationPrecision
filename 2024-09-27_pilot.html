<!DOCTYPE html>
<html>
  <head>
    
    <script src="https://unpkg.com/jspsych@7.3.4"></script>
    <script src="https://unpkg.com/@jspsych-contrib/plugin-image-swipe-response@1.0.0"></script>
    <!-- https://www.jspsych.org/v7/plugins/html-button-response/ -->
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.2.0"></script>
    <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe@0.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-preload@2.0.0"></script>
    <link href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css" rel="stylesheet" /> 
    <style>
      /* document.body.style.backgroundColor = '#808080'   */
      body {
        background-color: rgba(0.5, 0.5, 0.5, 0.5);
      }      
    </style>
  </head>
  <body></body>
  <script>
    const timeline = [];

    var preload = {
      type: jsPsychPreload,
      auto_preload: true
    };
    timeline.push(preload);

    // https://github.com/jspsych/jspsych-contrib/tree/main/packages/plugin-image-swipe-response
    const trials = {
      type: jsPsychImageSwipeResponse,
      // prompt: '<p>Press  left or right.</p>',
      choices: ['ArrowLeft', 'ArrowRight'],
      stimulus_duration: null,
      stimulus_height: Math.min(window.screen.height, window.screen.width),
      stimulus_width: Math.min(window.screen.height, window.screen.width),
      maintain_aspect_ratio: true,
      timeline: [
          {stimulus: 'img_pilot/0.png'},
          {stimulus: 'img_pilot/1.png'},
          {stimulus: 'img_pilot/2.png'},
          {stimulus: 'img_pilot/3.png'},
          {stimulus: 'img_pilot/4.png'},
          {stimulus: 'img_pilot/5.png'},
          {stimulus: 'img_pilot/6.png'},
          {stimulus: 'img_pilot/7.png'},
          {stimulus: 'img_pilot/8.png'},
          {stimulus: 'img_pilot/9.png'},
          {stimulus: 'img_pilot/10.png'},
          {stimulus: 'img_pilot/11.png'},
          {stimulus: 'img_pilot/12.png'},
          {stimulus: 'img_pilot/13.png'},
          {stimulus: 'img_pilot/14.png'},
          {stimulus: 'img_pilot/15.png'},
          {stimulus: 'img_pilot/16.png'},
          {stimulus: 'img_pilot/17.png'},
          {stimulus: 'img_pilot/18.png'},
          {stimulus: 'img_pilot/19.png'},
          {stimulus: 'img_pilot/20.png'},
          {stimulus: 'img_pilot/21.png'},
          {stimulus: 'img_pilot/22.png'},
          {stimulus: 'img_pilot/23.png'},
          {stimulus: 'img_pilot/24.png'},
          {stimulus: 'img_pilot/25.png'},
          {stimulus: 'img_pilot/26.png'},
          {stimulus: 'img_pilot/27.png'},
          {stimulus: 'img_pilot/28.png'},
          {stimulus: 'img_pilot/29.png'},
          {stimulus: 'img_pilot/30.png'},
          {stimulus: 'img_pilot/31.png'},
          {stimulus: 'img_pilot/32.png'},
          {stimulus: 'img_pilot/33.png'},
          {stimulus: 'img_pilot/34.png'},
          {stimulus: 'img_pilot/35.png'},
          {stimulus: 'img_pilot/36.png'},
          {stimulus: 'img_pilot/37.png'},
          {stimulus: 'img_pilot/38.png'},
          {stimulus: 'img_pilot/39.png'},
          {stimulus: 'img_pilot/40.png'},
          {stimulus: 'img_pilot/41.png'},
          {stimulus: 'img_pilot/42.png'},
          {stimulus: 'img_pilot/43.png'},
          {stimulus: 'img_pilot/44.png'},
          {stimulus: 'img_pilot/45.png'},
          {stimulus: 'img_pilot/46.png'},
          {stimulus: 'img_pilot/47.png'},
          {stimulus: 'img_pilot/48.png'},
          {stimulus: 'img_pilot/49.png'},
          {stimulus: 'img_pilot/50.png'},
          {stimulus: 'img_pilot/51.png'},
          {stimulus: 'img_pilot/52.png'},
          {stimulus: 'img_pilot/53.png'},
          {stimulus: 'img_pilot/54.png'},
          {stimulus: 'img_pilot/55.png'},
          {stimulus: 'img_pilot/56.png'},
          {stimulus: 'img_pilot/57.png'},
          {stimulus: 'img_pilot/58.png'},
          {stimulus: 'img_pilot/59.png'},
          {stimulus: 'img_pilot/60.png'},
          {stimulus: 'img_pilot/61.png'},
          {stimulus: 'img_pilot/62.png'},
          {stimulus: 'img_pilot/63.png'},
          {stimulus: 'img_pilot/64.png'},
          {stimulus: 'img_pilot/65.png'},
          {stimulus: 'img_pilot/66.png'},
          {stimulus: 'img_pilot/67.png'},
          {stimulus: 'img_pilot/68.png'},
          {stimulus: 'img_pilot/69.png'},
          {stimulus: 'img_pilot/70.png'},
          {stimulus: 'img_pilot/71.png'},
          {stimulus: 'img_pilot/72.png'},
          {stimulus: 'img_pilot/73.png'},
          {stimulus: 'img_pilot/74.png'},
          {stimulus: 'img_pilot/75.png'},
          {stimulus: 'img_pilot/76.png'},
          {stimulus: 'img_pilot/77.png'},
          {stimulus: 'img_pilot/78.png'},
          {stimulus: 'img_pilot/79.png'},
          {stimulus: 'img_pilot/80.png'},
          {stimulus: 'img_pilot/81.png'},
          {stimulus: 'img_pilot/82.png'},
          {stimulus: 'img_pilot/83.png'},
          {stimulus: 'img_pilot/84.png'},
          {stimulus: 'img_pilot/85.png'},
          {stimulus: 'img_pilot/86.png'},
          {stimulus: 'img_pilot/87.png'},
          {stimulus: 'img_pilot/88.png'},
          {stimulus: 'img_pilot/89.png'},
          {stimulus: 'img_pilot/90.png'},
          {stimulus: 'img_pilot/91.png'},
          {stimulus: 'img_pilot/92.png'},
          {stimulus: 'img_pilot/93.png'},
          {stimulus: 'img_pilot/94.png'},
          {stimulus: 'img_pilot/95.png'},
          {stimulus: 'img_pilot/96.png'},
          {stimulus: 'img_pilot/97.png'},
          {stimulus: 'img_pilot/98.png'},
          {stimulus: 'img_pilot/99.png'},
          {stimulus: 'img_pilot/100.png'},
          {stimulus: 'img_pilot/101.png'},
          {stimulus: 'img_pilot/102.png'},
          {stimulus: 'img_pilot/103.png'},
          {stimulus: 'img_pilot/104.png'},
          {stimulus: 'img_pilot/105.png'},
          {stimulus: 'img_pilot/106.png'},
          {stimulus: 'img_pilot/107.png'},
          {stimulus: 'img_pilot/108.png'},
          {stimulus: 'img_pilot/109.png'},
          {stimulus: 'img_pilot/110.png'},
          {stimulus: 'img_pilot/111.png'},
          {stimulus: 'img_pilot/112.png'},
          {stimulus: 'img_pilot/113.png'},
          {stimulus: 'img_pilot/114.png'},
          {stimulus: 'img_pilot/115.png'},
          {stimulus: 'img_pilot/116.png'},
          {stimulus: 'img_pilot/117.png'},
          {stimulus: 'img_pilot/118.png'},
          {stimulus: 'img_pilot/119.png'},
          {stimulus: 'img_pilot/120.png'},
          {stimulus: 'img_pilot/121.png'},
          {stimulus: 'img_pilot/122.png'},
          {stimulus: 'img_pilot/123.png'},
          {stimulus: 'img_pilot/124.png'},
          {stimulus: 'img_pilot/125.png'},
          {stimulus: 'img_pilot/126.png'},
          {stimulus: 'img_pilot/127.png'},
          {stimulus: 'img_pilot/128.png'},
          {stimulus: 'img_pilot/129.png'},
          {stimulus: 'img_pilot/130.png'},
          {stimulus: 'img_pilot/131.png'},
          {stimulus: 'img_pilot/132.png'},
          {stimulus: 'img_pilot/133.png'},
          {stimulus: 'img_pilot/134.png'},
          {stimulus: 'img_pilot/135.png'},
          {stimulus: 'img_pilot/136.png'},
          {stimulus: 'img_pilot/137.png'},
          {stimulus: 'img_pilot/138.png'},
          {stimulus: 'img_pilot/139.png'},
          {stimulus: 'img_pilot/140.png'},
          {stimulus: 'img_pilot/141.png'},
          {stimulus: 'img_pilot/142.png'},
          {stimulus: 'img_pilot/143.png'},
          {stimulus: 'img_pilot/144.png'},
          {stimulus: 'img_pilot/145.png'},
          {stimulus: 'img_pilot/146.png'},
          {stimulus: 'img_pilot/147.png'},
          {stimulus: 'img_pilot/148.png'},
          {stimulus: 'img_pilot/149.png'},
          {stimulus: 'img_pilot/150.png'},
          {stimulus: 'img_pilot/151.png'},
          {stimulus: 'img_pilot/152.png'},
          {stimulus: 'img_pilot/153.png'},
          {stimulus: 'img_pilot/154.png'},
          {stimulus: 'img_pilot/155.png'},
          {stimulus: 'img_pilot/156.png'},
          {stimulus: 'img_pilot/157.png'},
          {stimulus: 'img_pilot/158.png'},
          {stimulus: 'img_pilot/159.png'},
          {stimulus: 'img_pilot/160.png'},
          {stimulus: 'img_pilot/161.png'},
          {stimulus: 'img_pilot/162.png'},
          {stimulus: 'img_pilot/163.png'},
          {stimulus: 'img_pilot/164.png'},
          {stimulus: 'img_pilot/165.png'},
          {stimulus: 'img_pilot/166.png'},
          {stimulus: 'img_pilot/167.png'},
          {stimulus: 'img_pilot/168.png'},
          {stimulus: 'img_pilot/169.png'},
          {stimulus: 'img_pilot/170.png'},
          {stimulus: 'img_pilot/171.png'},
          {stimulus: 'img_pilot/172.png'},
          {stimulus: 'img_pilot/173.png'},
          {stimulus: 'img_pilot/174.png'},
          {stimulus: 'img_pilot/175.png'},
          {stimulus: 'img_pilot/176.png'},
          {stimulus: 'img_pilot/177.png'},
          {stimulus: 'img_pilot/178.png'},
          {stimulus: 'img_pilot/179.png'},
          {stimulus: 'img_pilot/180.png'},
          {stimulus: 'img_pilot/181.png'},
          {stimulus: 'img_pilot/182.png'},
          {stimulus: 'img_pilot/183.png'},
          {stimulus: 'img_pilot/184.png'},
          {stimulus: 'img_pilot/185.png'},
          {stimulus: 'img_pilot/186.png'},
          {stimulus: 'img_pilot/187.png'},
          {stimulus: 'img_pilot/188.png'},
          {stimulus: 'img_pilot/189.png'},
          {stimulus: 'img_pilot/190.png'},
          {stimulus: 'img_pilot/191.png'},
          {stimulus: 'img_pilot/192.png'},
          {stimulus: 'img_pilot/193.png'},
          {stimulus: 'img_pilot/194.png'},
          {stimulus: 'img_pilot/195.png'},
          {stimulus: 'img_pilot/196.png'},
          {stimulus: 'img_pilot/197.png'},
          {stimulus: 'img_pilot/198.png'},
          {stimulus: 'img_pilot/199.png'},
          {stimulus: 'img_pilot/200.png'},
          {stimulus: 'img_pilot/201.png'},
          {stimulus: 'img_pilot/202.png'},
          {stimulus: 'img_pilot/203.png'},
          {stimulus: 'img_pilot/204.png'},
          {stimulus: 'img_pilot/205.png'},
          {stimulus: 'img_pilot/206.png'},
          {stimulus: 'img_pilot/207.png'},
          {stimulus: 'img_pilot/208.png'},
          {stimulus: 'img_pilot/209.png'},
          {stimulus: 'img_pilot/210.png'},
          {stimulus: 'img_pilot/211.png'},
          {stimulus: 'img_pilot/212.png'},
          {stimulus: 'img_pilot/213.png'},
          {stimulus: 'img_pilot/214.png'},
          {stimulus: 'img_pilot/215.png'},
      ],
      on_finish: function() {
        // at the end of each trial, update the progress bar
        // based on the current value and the proportion to update for each trial
        var curr_progress_bar_value = jsPsych.getProgressBarCompleted();
        jsPsych.setProgressBar(curr_progress_bar_value + (1/216));
      }
    }    
    timeline.push(trials);

    var jsPsych = initJsPsych({
      show_progress_bar: true,
      default_iti: 200,
      on_finish: function(){
        window.location = "https://laurentperrinet.github.io/OEiL_OrientationPrecision/"
      }
    });    

    const filename = `pilot-${jsPsych.randomization.randomID(10)}-data.json`
    const save_data = {
      type: jsPsychPipe,
      action: "save",
      experiment_id: "lXM18cF9QE3z",
      filename: filename,
      data_string: ()=>jsPsych.data.get().json()
    };
    timeline.push(save_data);
    
    const byebye = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <p>Many thanks for your participation ! </p>
      `,
      post_trial_gap: 2000,
      trial_duration: 2000,
      stimulus_duration: 2000,
    }; 
    timeline.push(byebye);
    
    jsPsych.run(timeline);

    </script>
</html>