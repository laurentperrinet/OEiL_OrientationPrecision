<!-- https://www.jspsych.org/latest/plugins/image-button-response/ -->
<!DOCTYPE html>
<html>
  <head>

    <script src="https://unpkg.com/jspsych@8.0.2"></script>
    <!-- <script src="https://unpkg.com/@jspsych/plugin-canvas-slider-response@2.0.0"></script> -->
    <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@2.0.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.0.0"></script>
    <!-- <script src="https://unpkg.com/@jspsych/plugin-fullscreen@2.0.0"></script> -->
    <script src="https://unpkg.com/@jspsych/plugin-preload@2.0.0"></script>
    <link href="https://unpkg.com/jspsych@8.0.2/css/jspsych.css" rel="stylesheet" />
    <!-- <style>
      img {
        width: 1024px;
      }
            </style> -->
  </head>
  <body></body>
  <script>
    const timeline = [];

    /* define welcome message trial */
    // var welcome = {
    //   type: jsPsychHtmlKeyboardResponse,
    //   stimulus: "Welcome to the experiment. Press any key to begin."
    // };
    // timeline.push(welcome);

    // timeline.push({
    // type: jsPsychFullscreen,
    // fullscreen_mode: false
    // });

    function saveData(name, data){
      var xhr = new XMLHttpRequest();
      xhr.open('POST', 'write_data.php'); 
      xhr.setRequestHeader('Content-Type', 'application/json');
      // xhr.send(JSON.stringify({data: data}));
      xhr.send(JSON.stringify(data));
    }

    var preload = {
      type: jsPsychPreload,
      auto_preload: true
    };
    timeline.push(preload);

    var instructions = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
          <p>In this experiment, ...
          <p>Press any key to begin.</p>
          `,
    post_trial_gap: 2000
    }; 
    timeline.push(instructions);

    // https://www.jspsych.org/v8/plugins/image-keyboard-response/
    const trials = {
      type: jsPsychImageKeyboardResponse,
      // prompt: '<p>Press  left or right.</p>',
      choices: ['ArrowLeft', 'ArrowRight'],
      stimulus_duration: 500,
      stimulus_height: window.screen.height,
      timeline: [
          {stimulus: 'img_pilot_folder/0.png'},
          {stimulus: 'img_pilot_folder/1.png'},
          {stimulus: 'img_pilot_folder/2.png'},
          {stimulus: 'img_pilot_folder/3.png'},
          {stimulus: 'img_pilot_folder/4.png'},
          {stimulus: 'img_pilot_folder/5.png'},
          {stimulus: 'img_pilot_folder/6.png'},
          {stimulus: 'img_pilot_folder/7.png'},
          {stimulus: 'img_pilot_folder/8.png'},
          {stimulus: 'img_pilot_folder/9.png'},
          {stimulus: 'img_pilot_folder/10.png'},
          {stimulus: 'img_pilot_folder/11.png'},
          {stimulus: 'img_pilot_folder/12.png'},
          {stimulus: 'img_pilot_folder/13.png'},
          {stimulus: 'img_pilot_folder/14.png'},
          {stimulus: 'img_pilot_folder/15.png'},
          {stimulus: 'img_pilot_folder/16.png'},
          {stimulus: 'img_pilot_folder/17.png'},
          {stimulus: 'img_pilot_folder/18.png'},
          {stimulus: 'img_pilot_folder/19.png'},
          {stimulus: 'img_pilot_folder/20.png'},
          {stimulus: 'img_pilot_folder/21.png'},
          {stimulus: 'img_pilot_folder/22.png'},
          {stimulus: 'img_pilot_folder/23.png'},
          {stimulus: 'img_pilot_folder/24.png'},
          {stimulus: 'img_pilot_folder/25.png'},
          {stimulus: 'img_pilot_folder/26.png'},
          {stimulus: 'img_pilot_folder/27.png'},
          {stimulus: 'img_pilot_folder/28.png'},
          {stimulus: 'img_pilot_folder/29.png'},
          {stimulus: 'img_pilot_folder/30.png'},
          {stimulus: 'img_pilot_folder/31.png'},
          {stimulus: 'img_pilot_folder/32.png'},
          {stimulus: 'img_pilot_folder/33.png'},
          {stimulus: 'img_pilot_folder/34.png'},
          {stimulus: 'img_pilot_folder/35.png'},
          {stimulus: 'img_pilot_folder/36.png'},
          {stimulus: 'img_pilot_folder/37.png'},
          {stimulus: 'img_pilot_folder/38.png'},
          {stimulus: 'img_pilot_folder/39.png'},
          {stimulus: 'img_pilot_folder/40.png'},
          {stimulus: 'img_pilot_folder/41.png'},
          {stimulus: 'img_pilot_folder/42.png'},
          {stimulus: 'img_pilot_folder/43.png'},
          {stimulus: 'img_pilot_folder/44.png'},
          {stimulus: 'img_pilot_folder/45.png'},
          {stimulus: 'img_pilot_folder/46.png'},
          {stimulus: 'img_pilot_folder/47.png'},
          {stimulus: 'img_pilot_folder/48.png'},
          {stimulus: 'img_pilot_folder/49.png'},
          {stimulus: 'img_pilot_folder/50.png'},
          {stimulus: 'img_pilot_folder/51.png'},
          {stimulus: 'img_pilot_folder/52.png'},
          {stimulus: 'img_pilot_folder/53.png'},
          {stimulus: 'img_pilot_folder/54.png'},
          {stimulus: 'img_pilot_folder/55.png'},
          {stimulus: 'img_pilot_folder/56.png'},
          {stimulus: 'img_pilot_folder/57.png'},
          {stimulus: 'img_pilot_folder/58.png'},
          {stimulus: 'img_pilot_folder/59.png'},
          {stimulus: 'img_pilot_folder/60.png'},
          {stimulus: 'img_pilot_folder/61.png'},
          {stimulus: 'img_pilot_folder/62.png'},
          {stimulus: 'img_pilot_folder/63.png'},
          {stimulus: 'img_pilot_folder/64.png'},
          {stimulus: 'img_pilot_folder/65.png'},
          {stimulus: 'img_pilot_folder/66.png'},
          {stimulus: 'img_pilot_folder/67.png'},
          {stimulus: 'img_pilot_folder/68.png'},
          {stimulus: 'img_pilot_folder/69.png'},
          {stimulus: 'img_pilot_folder/70.png'},
          {stimulus: 'img_pilot_folder/71.png'},
          {stimulus: 'img_pilot_folder/72.png'},
          {stimulus: 'img_pilot_folder/73.png'},
          {stimulus: 'img_pilot_folder/74.png'},
          {stimulus: 'img_pilot_folder/75.png'},
          {stimulus: 'img_pilot_folder/76.png'},
          {stimulus: 'img_pilot_folder/77.png'},
          {stimulus: 'img_pilot_folder/78.png'},
          {stimulus: 'img_pilot_folder/79.png'},
          {stimulus: 'img_pilot_folder/80.png'},
          {stimulus: 'img_pilot_folder/81.png'},
          {stimulus: 'img_pilot_folder/82.png'},
          {stimulus: 'img_pilot_folder/83.png'},
          {stimulus: 'img_pilot_folder/84.png'},
          {stimulus: 'img_pilot_folder/85.png'},
          {stimulus: 'img_pilot_folder/86.png'},
          {stimulus: 'img_pilot_folder/87.png'},
          {stimulus: 'img_pilot_folder/88.png'},
          {stimulus: 'img_pilot_folder/89.png'},
          {stimulus: 'img_pilot_folder/90.png'},
          {stimulus: 'img_pilot_folder/91.png'},
          {stimulus: 'img_pilot_folder/92.png'},
          {stimulus: 'img_pilot_folder/93.png'},
          {stimulus: 'img_pilot_folder/94.png'},
          {stimulus: 'img_pilot_folder/95.png'},
          {stimulus: 'img_pilot_folder/96.png'},
          {stimulus: 'img_pilot_folder/97.png'},
          {stimulus: 'img_pilot_folder/98.png'},
          {stimulus: 'img_pilot_folder/99.png'},
          {stimulus: 'img_pilot_folder/100.png'},
          {stimulus: 'img_pilot_folder/101.png'},
          {stimulus: 'img_pilot_folder/102.png'},
          {stimulus: 'img_pilot_folder/103.png'},
          {stimulus: 'img_pilot_folder/104.png'},
          {stimulus: 'img_pilot_folder/105.png'},
          {stimulus: 'img_pilot_folder/106.png'},
          {stimulus: 'img_pilot_folder/107.png'},
          {stimulus: 'img_pilot_folder/108.png'},
          {stimulus: 'img_pilot_folder/109.png'},
          {stimulus: 'img_pilot_folder/110.png'},
          {stimulus: 'img_pilot_folder/111.png'},
          {stimulus: 'img_pilot_folder/112.png'},
          {stimulus: 'img_pilot_folder/113.png'},
          {stimulus: 'img_pilot_folder/114.png'},
          {stimulus: 'img_pilot_folder/115.png'},
          {stimulus: 'img_pilot_folder/116.png'},
          {stimulus: 'img_pilot_folder/117.png'},
          {stimulus: 'img_pilot_folder/118.png'},
          {stimulus: 'img_pilot_folder/119.png'},
          {stimulus: 'img_pilot_folder/120.png'},
          {stimulus: 'img_pilot_folder/121.png'},
          {stimulus: 'img_pilot_folder/122.png'},
          {stimulus: 'img_pilot_folder/123.png'},
          {stimulus: 'img_pilot_folder/124.png'},
          {stimulus: 'img_pilot_folder/125.png'},
          {stimulus: 'img_pilot_folder/126.png'},
          {stimulus: 'img_pilot_folder/127.png'},
          {stimulus: 'img_pilot_folder/128.png'},
          {stimulus: 'img_pilot_folder/129.png'},
          {stimulus: 'img_pilot_folder/130.png'},
          {stimulus: 'img_pilot_folder/131.png'},
          {stimulus: 'img_pilot_folder/132.png'},
          {stimulus: 'img_pilot_folder/133.png'},
          {stimulus: 'img_pilot_folder/134.png'},
          {stimulus: 'img_pilot_folder/135.png'},
          {stimulus: 'img_pilot_folder/136.png'},
          {stimulus: 'img_pilot_folder/137.png'},
          {stimulus: 'img_pilot_folder/138.png'},
          {stimulus: 'img_pilot_folder/139.png'},
          {stimulus: 'img_pilot_folder/140.png'},
          {stimulus: 'img_pilot_folder/141.png'},
          {stimulus: 'img_pilot_folder/142.png'},
          {stimulus: 'img_pilot_folder/143.png'},
          {stimulus: 'img_pilot_folder/144.png'},
          {stimulus: 'img_pilot_folder/145.png'},
          {stimulus: 'img_pilot_folder/146.png'},
          {stimulus: 'img_pilot_folder/147.png'},
          {stimulus: 'img_pilot_folder/148.png'},
          {stimulus: 'img_pilot_folder/149.png'},
          {stimulus: 'img_pilot_folder/150.png'},
          {stimulus: 'img_pilot_folder/151.png'},
          {stimulus: 'img_pilot_folder/152.png'},
          {stimulus: 'img_pilot_folder/153.png'},
          {stimulus: 'img_pilot_folder/154.png'},
          {stimulus: 'img_pilot_folder/155.png'},
          {stimulus: 'img_pilot_folder/156.png'},
          {stimulus: 'img_pilot_folder/157.png'},
          {stimulus: 'img_pilot_folder/158.png'},
          {stimulus: 'img_pilot_folder/159.png'},
          {stimulus: 'img_pilot_folder/160.png'},
          {stimulus: 'img_pilot_folder/161.png'},
          {stimulus: 'img_pilot_folder/162.png'},
          {stimulus: 'img_pilot_folder/163.png'},
          {stimulus: 'img_pilot_folder/164.png'},
          {stimulus: 'img_pilot_folder/165.png'},
          {stimulus: 'img_pilot_folder/166.png'},
          {stimulus: 'img_pilot_folder/167.png'},
          {stimulus: 'img_pilot_folder/168.png'},
          {stimulus: 'img_pilot_folder/169.png'},
          {stimulus: 'img_pilot_folder/170.png'},
          {stimulus: 'img_pilot_folder/171.png'},
          {stimulus: 'img_pilot_folder/172.png'},
          {stimulus: 'img_pilot_folder/173.png'},
          {stimulus: 'img_pilot_folder/174.png'},
          {stimulus: 'img_pilot_folder/175.png'},
          {stimulus: 'img_pilot_folder/176.png'},
          {stimulus: 'img_pilot_folder/177.png'},
          {stimulus: 'img_pilot_folder/178.png'},
          {stimulus: 'img_pilot_folder/179.png'},
          {stimulus: 'img_pilot_folder/180.png'},
          {stimulus: 'img_pilot_folder/181.png'},
          {stimulus: 'img_pilot_folder/182.png'},
          {stimulus: 'img_pilot_folder/183.png'},
          {stimulus: 'img_pilot_folder/184.png'},
          {stimulus: 'img_pilot_folder/185.png'},
          {stimulus: 'img_pilot_folder/186.png'},
          {stimulus: 'img_pilot_folder/187.png'},
          {stimulus: 'img_pilot_folder/188.png'},
          {stimulus: 'img_pilot_folder/189.png'},
          {stimulus: 'img_pilot_folder/190.png'},
          {stimulus: 'img_pilot_folder/191.png'},
          {stimulus: 'img_pilot_folder/192.png'},
          {stimulus: 'img_pilot_folder/193.png'},
          {stimulus: 'img_pilot_folder/194.png'},
          {stimulus: 'img_pilot_folder/195.png'},
          {stimulus: 'img_pilot_folder/196.png'},
          {stimulus: 'img_pilot_folder/197.png'},
          {stimulus: 'img_pilot_folder/198.png'},
          {stimulus: 'img_pilot_folder/199.png'},
          {stimulus: 'img_pilot_folder/200.png'},
          {stimulus: 'img_pilot_folder/201.png'},
          {stimulus: 'img_pilot_folder/202.png'},
          {stimulus: 'img_pilot_folder/203.png'},
          {stimulus: 'img_pilot_folder/204.png'},
          {stimulus: 'img_pilot_folder/205.png'},
          {stimulus: 'img_pilot_folder/206.png'},
          {stimulus: 'img_pilot_folder/207.png'},
          {stimulus: 'img_pilot_folder/208.png'},
          {stimulus: 'img_pilot_folder/209.png'},
          {stimulus: 'img_pilot_folder/210.png'},
          {stimulus: 'img_pilot_folder/211.png'},
          {stimulus: 'img_pilot_folder/212.png'},
          {stimulus: 'img_pilot_folder/213.png'},
          {stimulus: 'img_pilot_folder/214.png'},
          {stimulus: 'img_pilot_folder/215.png'},
      ]
    }
    
    timeline.push(trials);

    var byebye = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: `
          <p>Many thanks for your participation ! </p>
          `,
    post_trial_gap: 2000
    }; 
    timeline.push(byebye);

    // https://www.jspsych.org/v8/overview/data/#storing-data-permanently-as-a-file
    function saveData( data){
      var xhr = new XMLHttpRequest();
      xhr.open('POST', 'write_data.php'); // 'write_data.php' is the path to the php file described above.
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.send(JSON.stringify({filedata: data}));
    }

    // call the saveData function after the experiment is over
    var jsPsych = initJsPsych({
      on_finish: function(){ saveData(jsPsych.data.get().filter({trial_type:'image-keyboard-response'}).csv()); }
      });      
    
    jsPsych.run(timeline);
    </script>
</html>